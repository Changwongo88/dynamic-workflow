<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>í˜¸ë‘ ìŠ¤íŠœë””ì˜¤ Dynamic Workflow</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Apple SD Gothic Neo', 'Noto Sans KR', 'Malgun Gothic', sans-serif;
            background: linear-gradient(135deg, #0f0c29 0%, #302b63 50%, #24243e 100%);
            min-height: 100vh;
            overflow: hidden;
            color: white;
        }

        .header {
            background: rgba(0, 0, 0, 0.5);
            backdrop-filter: blur(10px);
            padding: 15px 30px;
            box-shadow: 0 4px 30px rgba(0, 0, 0, 0.3);
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            z-index: 1000;
            border-bottom: 2px solid rgba(255, 255, 255, 0.1);
        }

        .header h1 {
            font-size: 24px;
            font-weight: 900;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            -webkit-background-clip: text;
            background-clip: text;
            -webkit-text-fill-color: transparent;
            margin-bottom: 3px;
        }

        .header p {
            font-size: 12px;
            color: rgba(255, 255, 255, 0.7);
        }

        .controls {
            background: rgba(0, 0, 0, 0.3);
            padding: 12px 30px;
            display: flex;
            gap: 20px;
            align-items: center;
            flex-wrap: wrap;
            position: fixed;
            top: 80px;
            left: 0;
            right: 0;
            z-index: 999;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }

        .stats {
            display: flex;
            gap: 25px;
            align-items: center;
            flex: 1;
        }

        .stat-item {
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .stat-label {
            font-size: 11px;
            color: rgba(255, 255, 255, 0.6);
        }

        .stat-value {
            font-size: 18px;
            font-weight: 700;
        }

        .stat-value.active {
            color: #00ff88;
            animation: pulse 2s infinite;
        }

        .stat-value.dormant {
            color: #ff4444;
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }

        button {
            padding: 8px 16px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-size: 12px;
            font-weight: 600;
            transition: all 0.3s;
        }

        button:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 20px rgba(102, 126, 234, 0.5);
        }

        #viewport {
            position: fixed;
            top: 135px;
            left: 0;
            right: 400px;
            bottom: 70px;
            overflow: hidden;
            cursor: grab;
        }

        #viewport.grabbing {
            cursor: grabbing;
        }

        #canvas {
            position: absolute;
            transform-origin: 0 0;
            width: 100%;
            height: 100%;
        }

        svg#connections {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 1;
        }

        #orgContainer {
            position: relative;
            padding: 50px;
            display: flex;
            gap: 3px;
            min-height: 100%;
        }

        /* ì»¬ëŸ¼ (ì§ì† ì¡°ì§ ë¼ì¸) */
        .org-column {
            flex: 1;
            min-width: 350px;
            background: rgba(255, 255, 255, 0.02);
            border-right: 1px solid rgba(255, 255, 255, 0.1);
            padding: 30px 20px;
            display: flex;
            flex-direction: column;
            gap: 40px;
            position: relative;
        }
        
        .org-column.wide {
            flex: 2;
            min-width: 700px;
        }

        .org-column:nth-child(1) { background: rgba(231, 76, 60, 0.03); }
        .org-column:nth-child(2) { background: rgba(52, 152, 219, 0.03); }
        .org-column:nth-child(3) { background: rgba(46, 204, 113, 0.03); }
        .org-column:nth-child(4) { background: rgba(155, 89, 182, 0.03); }
        .org-column:nth-child(5) { background: rgba(241, 196, 15, 0.03); }

        .column-label {
            position: sticky;
            top: 0;
            background: rgba(0, 0, 0, 0.5);
            backdrop-filter: blur(10px);
            padding: 12px 15px;
            border-radius: 10px;
            text-align: center;
            font-size: 13px;
            font-weight: 700;
            color: rgba(255, 255, 255, 0.9);
            margin-bottom: 10px;
            z-index: 10;
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .org-card {
            background: rgba(255, 255, 255, 0.05);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            padding: 25px;
            border: 2px solid rgba(255, 255, 255, 0.1);
            transition: all 0.3s;
            position: relative;
        }
        
        .org-card.wide {
            min-width: 100%;
        }


        .org-header {
            display: flex;
            align-items: center;
            gap: 15px;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 2px solid rgba(255, 255, 255, 0.1);
        }

        .org-icon {
            width: 50px;
            height: 50px;
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 20px;
            font-weight: 900;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
        }

        .org-info h3 {
            font-size: 16px;
            font-weight: 700;
            margin-bottom: 5px;
        }

        .org-info p {
            font-size: 11px;
            color: rgba(255, 255, 255, 0.6);
        }

        .leader-section {
            margin-bottom: 15px;
            padding: 10px;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 10px;
        }

        .leader-label {
            font-size: 10px;
            color: rgba(255, 255, 255, 0.5);
            margin-bottom: 8px;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .members {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
        }

        .member {
            position: relative;
            padding: 8px 14px;
            border-radius: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 11px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            border: 2px solid rgba(255, 255, 255, 0.2);
            min-width: 65px;
            white-space: nowrap;
        }

        .member::before {
            content: '';
            position: absolute;
            inset: -4px;
            border-radius: 20px;
            opacity: 0;
            transition: opacity 0.3s;
        }

        .member.active {
            animation: memberGlow 2s infinite;
            box-shadow: 0 0 20px currentColor;
        }

        .member.active::before {
            opacity: 1;
            animation: ripple 2s infinite;
            background: currentColor;
        }

        @keyframes memberGlow {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }

        @keyframes ripple {
            0% {
                opacity: 0.6;
                transform: scale(1);
            }
            100% {
                opacity: 0;
                transform: scale(1.4);
            }
        }

        .member.dormant {
            background: linear-gradient(135deg, #ff4444 0%, #cc0000 100%) !important;
            animation: warning 1s infinite;
            border-color: #ff0000;
        }

        @keyframes warning {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.4; }
        }

        .member:hover {
            transform: scale(1.15);
            z-index: 10;
        }

        .member-tooltip {
            position: absolute;
            bottom: 110%;
            left: 50%;
            transform: translateX(-50%);
            background: rgba(0, 0, 0, 0.95);
            padding: 8px 12px;
            border-radius: 8px;
            font-size: 11px;
            white-space: nowrap;
            opacity: 0;
            pointer-events: none;
            transition: opacity 0.3s;
            z-index: 100;
        }

        .member:hover .member-tooltip {
            opacity: 1;
        }

        /* ìƒ‰ìƒ ì •ì˜ */
        .level-0 .org-icon { background: linear-gradient(135deg, #e74c3c 0%, #c0392b 100%); }
        .level-1 .org-icon { background: linear-gradient(135deg, #3498db 0%, #2980b9 100%); }
        .level-2 .org-icon { background: linear-gradient(135deg, #2ecc71 0%, #27ae60 100%); }
        .level-3 .org-icon { background: linear-gradient(135deg, #f39c12 0%, #e67e22 100%); }
        .level-4 .org-icon { background: linear-gradient(135deg, #9b59b6 0%, #8e44ad 100%); }

        .member.level-0 { background: linear-gradient(135deg, #e74c3c 0%, #c0392b 100%); color: white; }
        .member.level-1 { background: linear-gradient(135deg, #3498db 0%, #2980b9 100%); color: white; }
        .member.level-2 { background: linear-gradient(135deg, #2ecc71 0%, #27ae60 100%); color: white; }
        .member.level-3 { background: linear-gradient(135deg, #f39c12 0%, #e67e22 100%); color: white; }
        .member.level-4 { background: linear-gradient(135deg, #9b59b6 0%, #8e44ad 100%); color: white; }
        .member.level-5 { background: linear-gradient(135deg, #1abc9c 0%, #16a085 100%); color: white; }

        .connection-line {
            stroke-width: 2;
            fill: none;
            stroke: rgba(150, 180, 255, 0.5);
            stroke-dasharray: 3, 3;
        }

        .connection-line.active {
            stroke: #00ff88;
            stroke-width: 3;
            opacity: 1;
            animation: flowLine 2s infinite;
            filter: drop-shadow(0 0 5px #00ff88);
            stroke-dasharray: 10, 5;
        }

        @keyframes flowLine {
            0% { stroke-dashoffset: 20; }
            100% { stroke-dashoffset: 0; }
        }

        .zoom-controls {
            position: fixed;
            bottom: 90px;
            right: 30px;
            display: flex;
            flex-direction: column;
            gap: 10px;
            z-index: 1000;
        }

        .zoom-btn {
            width: 45px;
            height: 45px;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border: 2px solid rgba(255, 255, 255, 0.3);
            font-size: 22px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: 700;
            transition: all 0.3s;
        }

        .zoom-btn:hover {
            background: rgba(255, 255, 255, 0.2);
            transform: scale(1.1);
        }

        .legend {
            position: fixed;
            top: 150px;
            right: 430px;
            background: rgba(0, 0, 0, 0.7);
            backdrop-filter: blur(10px);
            padding: 15px;
            border-radius: 12px;
            border: 2px solid rgba(255, 255, 255, 0.1);
            max-width: 200px;
            z-index: 1000;
            font-size: 11px;
        }

        .legend-title {
            font-size: 12px;
            font-weight: 700;
            margin-bottom: 12px;
            color: #00ff88;
        }

        .legend-item {
            display: flex;
            align-items: center;
            gap: 8px;
            margin-bottom: 8px;
            font-size: 10px;
        }

        .legend-dot {
            width: 16px;
            height: 16px;
            border-radius: 20px;
            border: 2px solid rgba(255, 255, 255, 0.3);
        }

        .activity-bar {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 400px;
            height: 70px;
            background: rgba(0, 0, 0, 0.8);
            backdrop-filter: blur(10px);
            display: flex;
            align-items: center;
            padding: 0 30px;
            gap: 25px;
            border-top: 2px solid rgba(255, 255, 255, 0.1);
            z-index: 1000;
        }
        
        /* ë¦¬ë”ë³´ë“œ ìŠ¤íƒ€ì¼ */
        .leaderboard-panel {
            position: fixed;
            top: 80px;
            right: 0;
            width: 400px;
            height: calc(100vh - 80px);
            background: rgba(0, 0, 0, 0.7);
            backdrop-filter: blur(15px);
            border-left: 2px solid rgba(255, 255, 255, 0.1);
            z-index: 999;
            display: flex;
            flex-direction: column;
            overflow: hidden;
        }
        
        .leaderboard-header {
            padding: 20px;
            background: rgba(0, 0, 0, 0.5);
            border-bottom: 2px solid rgba(255, 255, 255, 0.1);
        }
        
        .leaderboard-title {
            font-size: 20px;
            font-weight: 700;
            margin-bottom: 5px;
            background: linear-gradient(135deg, #ffd700 0%, #ffed4e 100%);
            -webkit-background-clip: text;
            background-clip: text;
            -webkit-text-fill-color: transparent;
        }
        
        .leaderboard-subtitle {
            font-size: 12px;
            color: rgba(255, 255, 255, 0.5);
            margin-bottom: 15px;
        }
        
        .leaderboard-dropdown {
            width: 100%;
            padding: 10px 15px;
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 8px;
            color: white;
            font-size: 14px;
            cursor: pointer;
            outline: none;
            transition: all 0.3s ease;
        }
        
        .leaderboard-dropdown:hover {
            background: rgba(255, 255, 255, 0.15);
            border-color: rgba(255, 255, 255, 0.3);
        }
        
        .leaderboard-dropdown option {
            background: #1a1a2e;
            color: white;
        }
        
        .week-selector {
            display: flex;
            gap: 8px;
            margin-top: 12px;
            justify-content: space-between;
        }
        
        .week-btn {
            flex: 1;
            padding: 8px;
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 6px;
            color: white;
            font-size: 12px;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .week-btn:hover {
            background: rgba(255, 255, 255, 0.15);
        }
        
        .week-btn.active {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border-color: #667eea;
            font-weight: 700;
        }
        
        .week-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }
        
        .week-btn.current-week {
            border: 2px solid #00ff88;
            box-shadow: 0 0 10px rgba(0, 255, 136, 0.3);
        }
        
        .month-selector {
            display: flex;
            gap: 8px;
            margin-bottom: 10px;
        }
        
        .month-dropdown {
            flex: 1;
            padding: 8px 12px;
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 6px;
            color: white;
            font-size: 13px;
            cursor: pointer;
            outline: none;
        }
        
        .month-dropdown option {
            background: #1a1a2e;
            color: white;
        }
        
        .empty-message {
            text-align: center;
            padding: 60px 20px;
            color: rgba(255, 255, 255, 0.5);
            font-size: 14px;
            line-height: 1.6;
        }
        
        .empty-message-icon {
            font-size: 48px;
            margin-bottom: 15px;
            opacity: 0.3;
        }
        
        .leaderboard-content {
            flex: 1;
            overflow-y: auto;
            padding: 20px;
        }
        
        .leaderboard-content::-webkit-scrollbar {
            width: 8px;
        }
        
        .leaderboard-content::-webkit-scrollbar-track {
            background: rgba(255, 255, 255, 0.05);
        }
        
        .leaderboard-content::-webkit-scrollbar-thumb {
            background: rgba(255, 255, 255, 0.2);
            border-radius: 4px;
        }
        
        .rank-item {
            display: flex;
            align-items: center;
            padding: 12px 15px;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 10px;
            margin-bottom: 10px;
            transition: all 0.3s ease;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .rank-item:hover {
            background: rgba(255, 255, 255, 0.1);
            transform: translateX(-5px);
        }
        
        .rank-number {
            width: 35px;
            height: 35px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 900;
            font-size: 16px;
            border-radius: 8px;
            margin-right: 12px;
        }
        
        .rank-item.rank-1 .rank-number {
            background: linear-gradient(135deg, #ffd700 0%, #ffed4e 100%);
            color: #000;
            box-shadow: 0 0 20px rgba(255, 215, 0, 0.5);
        }
        
        .rank-item.rank-2 .rank-number {
            background: linear-gradient(135deg, #c0c0c0 0%, #e8e8e8 100%);
            color: #000;
            box-shadow: 0 0 15px rgba(192, 192, 192, 0.5);
        }
        
        .rank-item.rank-3 .rank-number {
            background: linear-gradient(135deg, #cd7f32 0%, #e39d5e 100%);
            color: #000;
            box-shadow: 0 0 15px rgba(205, 127, 50, 0.5);
        }
        
        .rank-item:not(.rank-1):not(.rank-2):not(.rank-3) .rank-number {
            background: rgba(255, 255, 255, 0.1);
            color: rgba(255, 255, 255, 0.6);
        }
        
        .rank-info {
            flex: 1;
        }
        
        .rank-name {
            font-size: 15px;
            font-weight: 700;
            margin-bottom: 4px;
        }
        
        .rank-org {
            font-size: 11px;
            color: rgba(255, 255, 255, 0.5);
        }
        
        .rank-score {
            text-align: right;
            font-size: 18px;
            font-weight: 900;
            color: #667eea;
        }
        
        .rank-change {
            margin-left: 8px;
            font-size: 12px;
            padding: 2px 6px;
            border-radius: 4px;
        }
        
        .rank-change.up {
            color: #00ff88;
        }
        
        .rank-change.down {
            color: #ff4444;
        }
        
        .rank-change.same {
            color: rgba(255, 255, 255, 0.3);
        }

        .activity-item {
            flex: 1;
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .activity-label {
            font-size: 11px;
            color: rgba(255, 255, 255, 0.6);
            min-width: 70px;
        }

        .activity-progress {
            flex: 1;
            height: 8px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 10px;
            overflow: hidden;
            position: relative;
        }

        .activity-fill {
            height: 100%;
            border-radius: 10px;
            transition: width 0.5s;
            position: relative;
            overflow: hidden;
        }

        .activity-fill::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.3), transparent);
            animation: shimmer 2s infinite;
        }

        @keyframes shimmer {
            0% { transform: translateX(-100%); }
            100% { transform: translateX(100%); }
        }

        .activity-value {
            font-size: 13px;
            font-weight: 700;
            min-width: 35px;
            text-align: right;
        }
    </style>
</head>
<body>
    <div class="header">
        <h1>ğŸš‡ í˜¸ë‘ ìŠ¤íŠœë””ì˜¤ Dynamic Workflow</h1>
        <p>ì‹¤ì‹œê°„ ì—…ë¬´ íë¦„ & ì¡°ì§ í™œë™ ëª¨ë‹ˆí„°ë§ - ì§ì† ì¡°ì§ë³„ êµ¬íš ë·°</p>
    </div>

    <div class="controls">
        <div class="stats">
            <div class="stat-item">
                <span class="stat-label">í™œë™ ì¤‘:</span>
                <span class="stat-value active" id="activeCount">0</span>
            </div>
            <div class="stat-item">
                <span class="stat-label">ë¹„í™œì„±:</span>
                <span class="stat-value dormant" id="dormantCount">0</span>
            </div>
            <div class="stat-item">
                <span class="stat-label">í˜‘ì—…:</span>
                <span class="stat-value" id="collabCount" style="color: #00ff88;">0</span>
            </div>
        </div>
        <button onclick="toggleSimulation()">
            <span id="simBtn">â¸ ì¼ì‹œì •ì§€</span>
        </button>
        <button onclick="resetSimulation()">ğŸ”„ ë¦¬ì…‹</button>
        <input type="file" id="csvFile" accept=".csv" style="display: none;" onchange="loadCSV(event)">
        <button onclick="document.getElementById('csvFile').click()">ğŸ“ CSV</button>
    </div>

    <div id="viewport">
        <div id="canvas">
            <svg id="connections"></svg>
            <div id="orgContainer"></div>
        </div>
    </div>

    <div class="legend">
        <div class="legend-title">ìƒíƒœ ë²”ë¡€</div>
        <div class="legend-item">
            <div class="legend-dot" style="background: linear-gradient(135deg, #00ff88 0%, #00cc66 100%); box-shadow: 0 0 10px #00ff88;"></div>
            <span>í™œë™ ì¤‘</span>
        </div>
        <div class="legend-item">
            <div class="legend-dot" style="background: linear-gradient(135deg, #3498db 0%, #2980b9 100%);"></div>
            <span>ì¼ë°˜</span>
        </div>
        <div class="legend-item">
            <div class="legend-dot" style="background: linear-gradient(135deg, #ff4444 0%, #cc0000 100%); animation: warning 1s infinite;"></div>
            <span>ë¹„í™œì„±</span>
        </div>
    </div>

    <div class="zoom-controls">
        <button class="zoom-btn" onclick="zoomIn()">+</button>
        <button class="zoom-btn" onclick="zoomOut()">âˆ’</button>
        <button class="zoom-btn" onclick="resetView()" style="font-size: 18px;">âŒ‚</button>
    </div>

    <!-- ë¦¬ë”ë³´ë“œ íŒ¨ë„ -->
    <div class="leaderboard-panel">
        <div class="leaderboard-header">
            <div class="leaderboard-title">ğŸ† ë¦¬ë”ë³´ë“œ</div>
            <div class="leaderboard-subtitle" id="leaderboardSubtitle">11ì›” 4ì£¼ì°¨</div>
            <div class="month-selector">
                <select class="month-dropdown" id="monthSelector" onchange="changeMonth()">
                    <option value="1">1ì›”</option>
                    <option value="2">2ì›”</option>
                    <option value="3">3ì›”</option>
                    <option value="4">4ì›”</option>
                    <option value="5">5ì›”</option>
                    <option value="6">6ì›”</option>
                    <option value="7">7ì›”</option>
                    <option value="8">8ì›”</option>
                    <option value="9">9ì›”</option>
                    <option value="10">10ì›”</option>
                    <option value="11" selected>11ì›”</option>
                    <option value="12">12ì›”</option>
                </select>
            </div>
            <select class="leaderboard-dropdown" id="leaderboardCategory" onchange="updateLeaderboard()">
                <option value="collaboration">í˜‘ì—…ì´ ê°€ì¥ í™œë°œí•œ ì‚¬ëŒ</option>
                <option value="quality">í˜‘ì—…ì˜ ëŠ¥ë ¥ì´ ì¢‹ì€ ì‚¬ëŒ</option>
                <option value="overtime">ì•¼ê·¼ì„ ê°€ì¥ ë§ì´ í•˜ëŠ” ì‚¬ëŒ</option>
                <option value="deadline">ê¸°í•œì„ ê°€ì¥ ì˜ ì—„ìˆ˜í•˜ëŠ” ì‚¬ëŒ</option>
                <option value="suggestion">ê±´ì„¤ì ì¸ ì œì•ˆì„ ê°€ì¥ í™œë°œí•˜ê²Œ í•˜ëŠ” ì‚¬ëŒ</option>
                <option value="overall" selected>ì¢…í•© ìˆœìœ„</option>
            </select>
            <div class="week-selector" id="weekSelector">
                <!-- ì£¼ì°¨ ë²„íŠ¼ë“¤ì´ ì—¬ê¸°ì— ë™ì ìœ¼ë¡œ ì¶”ê°€ë©ë‹ˆë‹¤ -->
            </div>
        </div>
        <div class="leaderboard-content" id="leaderboardContent">
            <!-- ë¦¬ë”ë³´ë“œ í•­ëª©ë“¤ì´ ì—¬ê¸°ì— ë™ì ìœ¼ë¡œ ì¶”ê°€ë©ë‹ˆë‹¤ -->
        </div>
    </div>

    <div class="activity-bar">
        <div class="activity-item">
            <span class="activity-label">ê¸°íšíŒ€</span>
            <div class="activity-progress">
                <div class="activity-fill" id="activity-planning" style="background: linear-gradient(90deg, #2ecc71 0%, #27ae60 100%); width: 0%;"></div>
            </div>
            <span class="activity-value" id="value-planning">0%</span>
        </div>
        <div class="activity-item">
            <span class="activity-label">í”„ë¡œê·¸ë¨íŒ€</span>
            <div class="activity-progress">
                <div class="activity-fill" id="activity-program" style="background: linear-gradient(90deg, #3498db 0%, #2980b9 100%); width: 0%;"></div>
            </div>
            <span class="activity-value" id="value-program">0%</span>
        </div>
        <div class="activity-item">
            <span class="activity-label">ì•„íŠ¸íŒ€</span>
            <div class="activity-progress">
                <div class="activity-fill" id="activity-art" style="background: linear-gradient(90deg, #9b59b6 0%, #8e44ad 100%); width: 0%;"></div>
            </div>
            <span class="activity-value" id="value-art">0%</span>
        </div>
    </div>

    <script>
        let orgData = [];
        let currentOrgData = { organizations: [] };
        let orgMap = new Map();
        let memberElements = new Map();
        let orgElements = new Map();
        let simulationRunning = true;
        let activeMembers = new Set();
        let dormantMembers = new Set();
        let collaborations = [];
        
        let scale = 1;
        let translateX = 0;
        let translateY = 0;
        let isPanning = false;
        let startX = 0;
        let startY = 0;

        // CSV íŒŒì‹±
        function parseCSV(csvText) {
            const data = [];
            const lines = [];
            let currentLine = '';
            let inQuotes = false;
            
            for (let i = 0; i < csvText.length; i++) {
                const char = csvText[i];
                
                if (char === '"') {
                    inQuotes = !inQuotes;
                    currentLine += char;
                } else if (char === '\n' && !inQuotes) {
                    if (currentLine.trim()) {
                        lines.push(currentLine);
                    }
                    currentLine = '';
                } else {
                    currentLine += char;
                }
            }
            if (currentLine.trim()) {
                lines.push(currentLine);
            }
            
            for (let line of lines) {
                const cells = [];
                let currentCell = '';
                let inQuotes = false;
                
                for (let i = 0; i < line.length; i++) {
                    const char = line[i];
                    if (char === '"') {
                        inQuotes = !inQuotes;
                    } else if (char === ',' && !inQuotes) {
                        cells.push(currentCell.trim());
                        currentCell = '';
                    } else {
                        currentCell += char;
                    }
                }
                cells.push(currentCell.trim());
                data.push(cells);
            }
            
            return data;
        }

        // ì´ë¦„ ì •ê·œí™” í•¨ìˆ˜ (ê³µë°± ì œê±°, ê´„í˜¸ ì•ˆ í…ìŠ¤íŠ¸ ì œê±°)
        function normalizeName(text) {
            if (!text) return '';
            const cleaned = text.replace(/\n/g, ' ').replace(/"/g, '').trim();
            const nameMatch = cleaned.match(/^(.+?)\s*\(([^)]+)\)$/);
            return nameMatch ? nameMatch[1].trim() : cleaned;
        }
        
        // ì¡°ì§ êµ¬ì¡° ì¶”ì¶œ
        function extractOrgStructure(csvData) {
            const organizations = [];
            
            for (let i = 1; i < csvData.length; i++) {
                const row = csvData[i];
                if (!row[0] || row[0] === '') continue;
                
                const leaderRaw = row[2] ? row[2].replace(/\n/g, ' ').replace(/"/g, '').trim() : '';
                const leaderName = normalizeName(leaderRaw);
                
                const org = {
                    level: parseInt(row[0]),
                    name: row[1],
                    leader: leaderName,
                    leaderRaw: leaderRaw,
                    subOrgs: [],
                    members: []
                };
                
                for (let j = 3; j <= 9; j++) {
                    if (row[j] && row[j].trim()) {
                        org.subOrgs.push(row[j].trim());
                    }
                }
                
                for (let j = 10; j < row.length; j++) {
                    const cellValue = row[j];
                    if (cellValue && cellValue.trim() && cellValue.trim() !== '""') {
                        const memberRaw = cellValue.replace(/\n/g, ' ').replace(/"/g, '').trim();
                        if (memberRaw) {
                            const nameMatch = memberRaw.match(/^(.+?)\s*\(([^)]+)\)$/);
                            const memberName = nameMatch ? nameMatch[1].trim() : memberRaw;
                            org.members.push({
                                name: memberName,
                                role: nameMatch ? nameMatch[2].trim() : '',
                                fullText: memberRaw
                            });
                        }
                    }
                }
                
                organizations.push(org);
                orgMap.set(org.name, org);
            }
            
            return organizations;
        }

        // ì§ì† ì¡°ì§ íŠ¸ë¦¬ ë¹Œë“œ
        function buildOrgTree(organizations) {
            const lines = [];
            
            // í€„ë¦¬í‹° ë””ë ‰í„° ë¼ì¸
            const qualityLine = {
                name: 'í€„ë¦¬í‹° ë””ë ‰í„° ì¡°ì§ ë¼ì¸',
                orgs: [],
                subColumns: []
            };
            const qualityOrg = organizations.find(o => o.name === 'í€„ë¦¬í‹° ë””ë ‰í„° ì¡°ì§');
            if (qualityOrg) {
                qualityLine.orgs.push(qualityOrg);
                qualityOrg.subOrgs.forEach(subName => {
                    const sub = organizations.find(o => o.name === subName);
                    if (sub) qualityLine.orgs.push(sub);
                });
            }
            if (qualityLine.orgs.length > 0) lines.push(qualityLine);
            
            // ê¸°íšíŒ€ ë¼ì¸
            const planningLine = {
                name: 'ê¸°íšíŒ€ ë¼ì¸',
                orgs: [],
                subColumns: []
            };
            const planningTeam = organizations.find(o => o.name === 'ê¸°íšíŒ€');
            if (planningTeam) {
                planningLine.orgs.push(planningTeam);
                planningTeam.subOrgs.forEach(subName => {
                    const sub = organizations.find(o => o.name === subName);
                    if (sub) planningLine.orgs.push(sub);
                });
            }
            if (planningLine.orgs.length > 0) lines.push(planningLine);
            
            // í”„ë¡œê·¸ë¨íŒ€ ë¼ì¸
            const programLine = {
                name: 'í”„ë¡œê·¸ë¨íŒ€ ë¼ì¸',
                orgs: [],
                subColumns: []
            };
            const programTeam = organizations.find(o => o.name === 'í”„ë¡œê·¸ë¨íŒ€');
            if (programTeam) {
                programLine.orgs.push(programTeam);
                programTeam.subOrgs.forEach(subName => {
                    const sub = organizations.find(o => o.name === subName);
                    if (sub) programLine.orgs.push(sub);
                });
            }
            if (programLine.orgs.length > 0) lines.push(programLine);
            
            // ì•„íŠ¸íŒ€ ë¼ì¸ (2Dì™€ 3Dë¥¼ ì„œë¸Œì»¬ëŸ¼ìœ¼ë¡œ)
            const artLine = {
                name: 'ì•„íŠ¸íŒ€ ë¼ì¸',
                orgs: [],
                subColumns: []
            };
            const artTeam = organizations.find(o => o.name === 'ì•„íŠ¸íŒ€');
            if (artTeam) {
                artLine.orgs.push(artTeam);
                
                // 2D ì„œë¸Œì»¬ëŸ¼
                const art2dTeam = organizations.find(o => o.name === '2Dì•„íŠ¸íŒ€');
                if (art2dTeam) {
                    const subCol2D = {
                        name: '2Dì•„íŠ¸íŒ€',
                        orgs: [art2dTeam]
                    };
                    art2dTeam.subOrgs.forEach(subName => {
                        const sub = organizations.find(o => o.name === subName);
                        if (sub) subCol2D.orgs.push(sub);
                    });
                    artLine.subColumns.push(subCol2D);
                }
                
                // 3D ì„œë¸Œì»¬ëŸ¼
                const art3dTeam = organizations.find(o => o.name === '3Dì•„íŠ¸íŒ€');
                if (art3dTeam) {
                    const subCol3D = {
                        name: '3Dì•„íŠ¸íŒ€',
                        orgs: [art3dTeam]
                    };
                    art3dTeam.subOrgs.forEach(subName => {
                        const sub = organizations.find(o => o.name === subName);
                        if (sub) subCol3D.orgs.push(sub);
                    });
                    artLine.subColumns.push(subCol3D);
                }
            }
            if (artLine.orgs.length > 0) lines.push(artLine);
            
            return lines;
        }

        // ì¡°ì§ë„ ë Œë”ë§ (ì»¬ëŸ¼ ë°©ì‹)
        function renderOrganization(organizations) {
            const container = document.getElementById('orgContainer');
            container.innerHTML = '';
            memberElements.clear();
            orgElements.clear();
            
            // ì „ì—­ ë³€ìˆ˜ì— ì €ì¥
            currentOrgData.organizations = organizations;
            
            // ì¡°ì§ êµ¬ì¡° ë””ë²„ê¹…
            console.log('\n=== ì¡°ì§ êµ¬ì¡° ë¡œë“œë¨ ===');
            console.log(`ì´ ${organizations.length}ê°œ ì¡°ì§`);
            const level5Orgs = organizations.filter(o => o.level === 5);
            console.log(`ë ˆë²¨ 5 íŒŒíŠ¸: ${level5Orgs.length}ê°œ`);
            level5Orgs.slice(0, 3).forEach(org => {
                console.log(`  - ${org.name}: ë¦¬ë” [${org.leader}], ë©¤ë²„ ${org.members.length}ëª…`);
            });
            
            const lines = buildOrgTree(organizations);
            
            lines.forEach(line => {
                const column = document.createElement('div');
                column.className = 'org-column';
                
                // ì•„íŠ¸íŒ€ ë¼ì¸ì€ ë„ˆë¹„ë¥¼ ë‘ ë°°ë¡œ
                if (line.name === 'ì•„íŠ¸íŒ€ ë¼ì¸') {
                    column.classList.add('wide');
                }
                
                const label = document.createElement('div');
                label.className = 'column-label';
                label.textContent = line.name;
                column.appendChild(label);
                
                // ë©”ì¸ ì¡°ì§ë“¤
                line.orgs.forEach(org => {
                    const card = createOrgCard(org);
                    // ì•„íŠ¸íŒ€ ì¹´ë“œëŠ” ë„ˆë¹„ë¥¼ ë‘ ë°°ë¡œ
                    if (org.name === 'ì•„íŠ¸íŒ€') {
                        card.classList.add('wide');
                    }
                    column.appendChild(card);
                    orgElements.set(org.name, card);
                });
                
                // ì„œë¸Œì»¬ëŸ¼ì´ ìˆìœ¼ë©´ (ì•„íŠ¸íŒ€ì˜ ê²½ìš°)
                if (line.subColumns && line.subColumns.length > 0) {
                    const subColumnsContainer = document.createElement('div');
                    subColumnsContainer.style.display = 'flex';
                    subColumnsContainer.style.gap = '15px';
                    subColumnsContainer.style.marginTop = '20px';
                    
                    line.subColumns.forEach(subCol => {
                        const subColumn = document.createElement('div');
                        subColumn.style.flex = '1';
                        subColumn.style.background = 'rgba(255, 255, 255, 0.03)';
                        subColumn.style.borderRadius = '15px';
                        subColumn.style.padding = '15px';
                        subColumn.style.border = '1px solid rgba(255, 255, 255, 0.1)';
                        
                        const subLabel = document.createElement('div');
                        subLabel.style.fontSize = '11px';
                        subLabel.style.fontWeight = '600';
                        subLabel.style.color = 'rgba(255, 255, 255, 0.7)';
                        subLabel.style.marginBottom = '15px';
                        subLabel.style.textAlign = 'center';
                        subLabel.textContent = subCol.name;
                        subColumn.appendChild(subLabel);
                        
                        subCol.orgs.forEach(org => {
                            const card = createOrgCard(org);
                            card.style.marginBottom = '15px';
                            subColumn.appendChild(card);
                            orgElements.set(org.name, card);
                        });
                        
                        subColumnsContainer.appendChild(subColumn);
                    });
                    
                    column.appendChild(subColumnsContainer);
                }
                
                container.appendChild(column);
            });
            
            setTimeout(() => {
                drawOrgConnections();
                initializeDefaultStates();
            }, 200);
        }

        // ì¡°ì§ ì¹´ë“œ ìƒì„±
        function createOrgCard(org) {
            const card = document.createElement('div');
            card.className = `org-card level-${org.level - 1}`;
            card.setAttribute('data-org', org.name);
            
            const icon = document.createElement('div');
            icon.className = 'org-icon';
            icon.textContent = org.name.substring(0, 2);
            
            const info = document.createElement('div');
            info.className = 'org-info';
            info.innerHTML = `
                <h3>${org.name}</h3>
                <p>${org.subOrgs.length > 0 ? `ì§ì†: ${org.subOrgs.length}ê°œ ì¡°ì§` : ''}</p>
            `;
            
            const header = document.createElement('div');
            header.className = 'org-header';
            header.appendChild(icon);
            header.appendChild(info);
            
            card.appendChild(header);
            
            if (org.leader) {
                const leaderSection = document.createElement('div');
                leaderSection.className = 'leader-section';
                leaderSection.innerHTML = `<div class="leader-label">ì¡°ì§ ë¦¬ë”</div>`;
                
                const leaderEl = document.createElement('div');
                leaderEl.className = `member level-${org.level}`;
                leaderEl.setAttribute('data-member', org.leader);
                leaderEl.setAttribute('data-org', org.name);
                leaderEl.textContent = org.leader;
                
                const tooltip = document.createElement('div');
                tooltip.className = 'member-tooltip';
                tooltip.textContent = `${org.leader} (ë¦¬ë”)`;
                leaderEl.appendChild(tooltip);
                
                leaderSection.appendChild(leaderEl);
                card.appendChild(leaderSection);
                memberElements.set(org.leader, leaderEl);
            }
            
            if (org.members.length > 0) {
                const memberSection = document.createElement('div');
                memberSection.innerHTML = `<div class="leader-label">ì¡°ì§ì› (${org.members.length}ëª…)</div>`;
                
                const members = document.createElement('div');
                members.className = 'members';
                
                org.members.forEach((member) => {
                    const memberEl = document.createElement('div');
                    memberEl.className = `member level-${org.level}`;
                    memberEl.setAttribute('data-member', member.name);
                    memberEl.setAttribute('data-org', org.name);
                    memberEl.textContent = member.name;
                    
                    const tooltip = document.createElement('div');
                    tooltip.className = 'member-tooltip';
                    tooltip.textContent = `${member.name} (${member.role})`;
                    memberEl.appendChild(tooltip);
                    
                    members.appendChild(memberEl);
                    memberElements.set(member.name, memberEl);
                });
                
                memberSection.appendChild(members);
                card.appendChild(memberSection);
            }
            
            return card;
        }

        // ì¡°ì§ ê°„ ì—°ê²°ì„  ê·¸ë¦¬ê¸°
        function drawOrgConnections() {
            const svg = document.getElementById('connections');
            svg.querySelectorAll('.connection-line:not(.active)').forEach(el => el.remove());
            
            currentOrgData.organizations.forEach(org => {
                if (org.subOrgs && org.subOrgs.length > 0) {
                    const parentCard = orgElements.get(org.name);
                    if (!parentCard) return;
                    
                    const parentRect = getElementPosition(parentCard);
                    const parentX = parentRect.x + parentRect.width / 2;
                    const parentY = parentRect.y + parentRect.height;
                    
                    org.subOrgs.forEach(subOrgName => {
                        const childCard = orgElements.get(subOrgName);
                        if (!childCard) return;
                        
                        const childRect = getElementPosition(childCard);
                        const childX = childRect.x + childRect.width / 2;
                        const childY = childRect.y;
                        
                        const line = document.createElementNS('http://www.w3.org/2000/svg', 'line');
                        line.setAttribute('x1', parentX);
                        line.setAttribute('y1', parentY);
                        line.setAttribute('x2', childX);
                        line.setAttribute('y2', childY);
                        line.setAttribute('class', 'connection-line');
                        
                        svg.appendChild(line);
                    });
                }
            });
        }

        function getElementPosition(element) {
            const rect = element.getBoundingClientRect();
            const canvas = document.getElementById('canvas');
            const canvasRect = canvas.getBoundingClientRect();
            
            return {
                x: (rect.left - canvasRect.left) / scale,
                y: (rect.top - canvasRect.top) / scale,
                width: rect.width / scale,
                height: rect.height / scale
            };
        }

        function drawCollaborationLines() {
            const svg = document.getElementById('connections');
            svg.querySelectorAll('.connection-line.active').forEach(el => el.remove());
            
            let successCount = 0;
            let failCount = 0;
            
            collaborations.forEach(([name1, name2]) => {
                const el1 = memberElements.get(name1);
                const el2 = memberElements.get(name2);
                
                if (el1 && el2) {
                    const rect1 = getElementPosition(el1);
                    const rect2 = getElementPosition(el2);
                    
                    const x1 = rect1.x + rect1.width / 2;
                    const y1 = rect1.y + rect1.height / 2;
                    const x2 = rect2.x + rect2.width / 2;
                    const y2 = rect2.y + rect2.height / 2;
                    
                    const line = document.createElementNS('http://www.w3.org/2000/svg', 'path');
                    const midY = (y1 + y2) / 2;
                    const d = `M ${x1} ${y1} C ${x1} ${midY}, ${x2} ${midY}, ${x2} ${y2}`;
                    
                    line.setAttribute('d', d);
                    line.setAttribute('class', 'connection-line active');
                    
                    svg.appendChild(line);
                    successCount++;
                } else {
                    console.warn(`í˜‘ì—… ë¼ì¸ ì‹¤íŒ¨: ${name1} (${el1 ? 'ì°¾ìŒ' : 'ëª»ì°¾ìŒ'}) <-> ${name2} (${el2 ? 'ì°¾ìŒ' : 'ëª»ì°¾ìŒ'})`);
                    failCount++;
                }
            });
            
            console.log(`í˜‘ì—… ë¼ì¸: ì„±ê³µ ${successCount}ê°œ, ì‹¤íŒ¨ ${failCount}ê°œ`);
        }

        function initializeDefaultStates() {
            // ì´ˆê¸°í™”
            activeMembers.clear();
            dormantMembers.clear();
            collaborations = [];
            
            const allMembers = Array.from(memberElements.keys());
            console.log(`\n=== ì´ˆê¸° ìƒíƒœ ì„¤ì • ===`);
            console.log(`ì „ì²´ ë©¤ë²„ ìˆ˜: ${allMembers.length}`);
            console.log(`ì²« 10ëª…:`, allMembers.slice(0, 10));
            
            // í™œì„±/ë¹„í™œì„± ë©¤ë²„ ì„¤ì •
            const activeRate = 0.7; // 70%ë¥¼ í™œì„±ìœ¼ë¡œ
            allMembers.forEach(name => {
                if (Math.random() < activeRate) {
                    activeMembers.add(name);
                } else {
                    dormantMembers.add(name);
                }
            });
            
            console.log(`í™œì„± ë©¤ë²„: ${activeMembers.size}ëª…`);
            
            // 1. ì „ì²´ ëœë¤ í˜‘ì—… ìƒì„±
            const activeArray = Array.from(activeMembers);
            const generalCollabCount = Math.floor(20 + Math.random() * 10);
            
            for (let i = 0; i < generalCollabCount && activeArray.length > 1; i++) {
                const idx1 = Math.floor(Math.random() * activeArray.length);
                let idx2 = Math.floor(Math.random() * activeArray.length);
                let attempts = 0;
                while (idx2 === idx1 && attempts < 10) {
                    idx2 = Math.floor(Math.random() * activeArray.length);
                    attempts++;
                }
                if (idx1 !== idx2) {
                    collaborations.push([activeArray[idx1], activeArray[idx2]]);
                }
            }
            
            // 2. ì•„íŠ¸ íŒŒíŠ¸ ë©¤ë²„ë“¤ ìˆ˜ì§‘ (ë ˆë²¨ 5ì¸ ëª¨ë“  íŒŒíŠ¸)
            const artMembers = [];
            currentOrgData.organizations.forEach(org => {
                if (org.level === 5 && org.name.includes('íŒŒíŠ¸')) {
                    // ë©¤ë²„ ì¶”ê°€
                    org.members.forEach(member => {
                        if (activeMembers.has(member.name) && memberElements.has(member.name)) {
                            artMembers.push(member.name);
                        }
                    });
                    // ë¦¬ë” ì¶”ê°€
                    if (org.leader && activeMembers.has(org.leader) && memberElements.has(org.leader)) {
                        artMembers.push(org.leader);
                    }
                }
            });
            
            console.log(`\n=== ì•„íŠ¸íŒ€ í˜‘ì—… ===`);
            console.log(`ì•„íŠ¸íŒ€ í™œì„± ë©¤ë²„: ${artMembers.length}ëª…`, artMembers.slice(0, 5));
            
            // 3. ì•„íŠ¸ íŒŒíŠ¸ ê°„ í˜‘ì—… ì¶”ê°€ (15ê°œ)
            const artCollabCount = 15;
            let artCollabAdded = 0;
            
            for (let i = 0; i < artCollabCount && artMembers.length > 1; i++) {
                const idx1 = Math.floor(Math.random() * artMembers.length);
                let idx2 = Math.floor(Math.random() * artMembers.length);
                let attempts = 0;
                while (idx2 === idx1 && attempts < 10) {
                    idx2 = Math.floor(Math.random() * artMembers.length);
                    attempts++;
                }
                if (idx1 !== idx2) {
                    const name1 = artMembers[idx1];
                    const name2 = artMembers[idx2];
                    
                    // ì¤‘ë³µ ì²´í¬
                    const isDuplicate = collaborations.some(([n1, n2]) => 
                        (n1 === name1 && n2 === name2) || (n1 === name2 && n2 === name1)
                    );
                    
                    if (!isDuplicate) {
                        collaborations.push([name1, name2]);
                        artCollabAdded++;
                        if (i < 5) { // ì²˜ìŒ 5ê°œë§Œ ë¡œê·¸
                            console.log(`  ${artCollabAdded}. ${name1} <-> ${name2}`);
                        }
                    }
                }
            }
            
            console.log(`ì•„íŠ¸íŒ€ í˜‘ì—… ì¶”ê°€: ${artCollabAdded}ê°œ`);
            console.log(`ì´ í˜‘ì—… ìˆ˜: ${collaborations.length}ê°œ\n`);
            
            updateVisualization();
        }

        function startSimulation() {
            setInterval(() => {
                if (!simulationRunning) return;
                
                const allMembers = Array.from(memberElements.keys());
                activeMembers.clear();
                dormantMembers.clear();
                
                const activeRate = 0.65 + Math.random() * 0.2;
                allMembers.forEach(name => {
                    if (Math.random() < activeRate) {
                        activeMembers.add(name);
                    } else {
                        dormantMembers.add(name);
                    }
                });
                
                collaborations = [];
                
                // 1. ì „ì²´ ëœë¤ í˜‘ì—… ìƒì„±
                const activeArray = Array.from(activeMembers);
                const generalCollabCount = Math.floor(20 + Math.random() * 10);
                
                for (let i = 0; i < generalCollabCount && activeArray.length > 1; i++) {
                    const idx1 = Math.floor(Math.random() * activeArray.length);
                    let idx2 = Math.floor(Math.random() * activeArray.length);
                    let attempts = 0;
                    while (idx2 === idx1 && attempts < 10) {
                        idx2 = Math.floor(Math.random() * activeArray.length);
                        attempts++;
                    }
                    if (idx1 !== idx2) {
                        collaborations.push([activeArray[idx1], activeArray[idx2]]);
                    }
                }
                
                // 2. ì•„íŠ¸ íŒŒíŠ¸ ë©¤ë²„ë“¤ ìˆ˜ì§‘
                const artMembers = [];
                currentOrgData.organizations.forEach(org => {
                    if (org.level === 5 && org.name.includes('íŒŒíŠ¸')) {
                        org.members.forEach(member => {
                            if (activeMembers.has(member.name) && memberElements.has(member.name)) {
                                artMembers.push(member.name);
                            }
                        });
                        if (org.leader && activeMembers.has(org.leader) && memberElements.has(org.leader)) {
                            artMembers.push(org.leader);
                        }
                    }
                });
                
                // 3. ì•„íŠ¸ íŒŒíŠ¸ ê°„ í˜‘ì—… ì¶”ê°€
                const artCollabCount = 15;
                let artCollabAdded = 0;
                
                for (let i = 0; i < artCollabCount && artMembers.length > 1; i++) {
                    const idx1 = Math.floor(Math.random() * artMembers.length);
                    let idx2 = Math.floor(Math.random() * artMembers.length);
                    let attempts = 0;
                    while (idx2 === idx1 && attempts < 10) {
                        idx2 = Math.floor(Math.random() * artMembers.length);
                        attempts++;
                    }
                    if (idx1 !== idx2) {
                        const name1 = artMembers[idx1];
                        const name2 = artMembers[idx2];
                        
                        // ì¤‘ë³µ ì²´í¬
                        const isDuplicate = collaborations.some(([n1, n2]) => 
                            (n1 === name1 && n2 === name2) || (n1 === name2 && n2 === name1)
                        );
                        
                        if (!isDuplicate) {
                            collaborations.push([name1, name2]);
                            artCollabAdded++;
                        }
                    }
                }
                
                updateVisualization();
            }, 2500);
            
            setInterval(() => {
                if (!simulationRunning) return;
                updateTeamActivity();
            }, 1000);
        }

        function updateVisualization() {
            memberElements.forEach((el, name) => {
                el.classList.remove('active', 'dormant');
                if (activeMembers.has(name)) {
                    el.classList.add('active');
                } else if (dormantMembers.has(name)) {
                    el.classList.add('dormant');
                }
            });
            
            document.querySelectorAll('.org-card').forEach(card => {
                card.classList.remove('active');
                const members = card.querySelectorAll('.member');
                let hasActive = false;
                members.forEach(m => {
                    if (m.classList.contains('active')) hasActive = true;
                });
                if (hasActive) card.classList.add('active');
            });
            
            drawCollaborationLines();
            
            document.getElementById('activeCount').textContent = activeMembers.size;
            document.getElementById('dormantCount').textContent = dormantMembers.size;
            document.getElementById('collabCount').textContent = collaborations.length;
        }

        function updateTeamActivity() {
            const teams = {
                'ê¸°íšíŒ€': ['ë°¸ëŸ°ìŠ¤íŒŒíŠ¸', 'ì½˜í…ì¸ íŒŒíŠ¸', 'ì‹œìŠ¤í…œíŒŒíŠ¸', 'ê²Œì„UIíŒŒíŠ¸'],
                'í”„ë¡œê·¸ë¨íŒ€': ['í´ë¼ì´ì–¸íŠ¸íŒŒíŠ¸', 'ì„œë²„íŒŒíŠ¸'],
                'ì•„íŠ¸íŒ€': ['2Dì•„íŠ¸íŒ€', '3Dì•„íŠ¸íŒ€', 'ë„íŠ¸ë””ìì¸1íŒŒíŠ¸', 'ë„íŠ¸ë””ìì¸2íŒŒíŠ¸', 'ë„íŠ¸ì• ë‹ˆë©”ì´ì…˜1íŒŒíŠ¸', 'ë„íŠ¸ì• ë‹ˆë©”ì´ì…˜2íŒŒíŠ¸', 'ê°€ì´ë“œëª¨ë¸ë§íŒŒíŠ¸', 'ì»¨ì…‰ì›í™”íŒŒíŠ¸', 'ë°°ê²½ì›í™”íŒŒíŠ¸', 'ë°°ê²½ëª¨ë¸ë§íŒŒíŠ¸', 'ë°°ê²½ì›”ë“œë¹Œë”©íŒŒíŠ¸', '3Dìºë¦­í„°ëª¨ë¸ë§íŒŒíŠ¸', '3Dì• ë‹ˆë©”ì´ì…˜íŒŒíŠ¸', 'ì´í™íŠ¸íŒŒíŠ¸', 'TAíŒŒíŠ¸']
            };
            
            Object.keys(teams).forEach(teamName => {
                const subOrgs = teams[teamName];
                let totalMembers = 0;
                let activeCount = 0;
                
                subOrgs.forEach(subOrg => {
                    const org = orgData.find(o => o.name === subOrg);
                    if (org) {
                        totalMembers += org.members.length + (org.leader ? 1 : 0);
                        org.members.forEach(m => {
                            if (activeMembers.has(m.name)) activeCount++;
                        });
                        if (org.leader && activeMembers.has(org.leader)) activeCount++;
                    }
                });
                
                const percentage = totalMembers > 0 ? Math.round((activeCount / totalMembers) * 100) : 0;
                const key = teamName === 'ê¸°íšíŒ€' ? 'planning' : teamName === 'í”„ë¡œê·¸ë¨íŒ€' ? 'program' : 'art';
                
                document.getElementById(`activity-${key}`).style.width = percentage + '%';
                document.getElementById(`value-${key}`).textContent = percentage + '%';
            });
        }

        const viewport = document.getElementById('viewport');
        const canvas = document.getElementById('canvas');

        viewport.addEventListener('mousedown', (e) => {
            isPanning = true;
            startX = e.clientX - translateX;
            startY = e.clientY - translateY;
            viewport.classList.add('grabbing');
        });

        viewport.addEventListener('mousemove', (e) => {
            if (!isPanning) return;
            translateX = e.clientX - startX;
            translateY = e.clientY - startY;
            updateTransform();
        });

        viewport.addEventListener('mouseup', () => {
            isPanning = false;
            viewport.classList.remove('grabbing');
        });

        viewport.addEventListener('mouseleave', () => {
            isPanning = false;
            viewport.classList.remove('grabbing');
        });

        viewport.addEventListener('wheel', (e) => {
            e.preventDefault();
            const delta = e.deltaY > 0 ? 0.9 : 1.1;
            scale *= delta;
            scale = Math.max(0.3, Math.min(3, scale));
            updateTransform();
        });

        function updateTransform() {
            canvas.style.transform = `translate(${translateX}px, ${translateY}px) scale(${scale})`;
            const svg = document.getElementById('connections');
            const container = document.getElementById('orgContainer');
            svg.setAttribute('width', container.scrollWidth);
            svg.setAttribute('height', container.scrollHeight);
            
            setTimeout(() => {
                drawOrgConnections();
                if (collaborations.length > 0) {
                    drawCollaborationLines();
                }
            }, 50);
        }

        function zoomIn() {
            scale *= 1.2;
            scale = Math.min(3, scale);
            updateTransform();
        }

        function zoomOut() {
            scale *= 0.8;
            scale = Math.max(0.3, scale);
            updateTransform();
        }

        function resetView() {
            scale = 1;
            translateX = 0;
            translateY = 0;
            updateTransform();
        }

        function toggleSimulation() {
            simulationRunning = !simulationRunning;
            document.getElementById('simBtn').textContent = simulationRunning ? 'â¸ ì¼ì‹œì •ì§€' : 'â–¶ ì‹œì‘';
        }

        function resetSimulation() {
            activeMembers.clear();
            dormantMembers.clear();
            collaborations = [];
            initializeDefaultStates();
        }

        function loadCSV(event) {
            const file = event.target.files[0];
            if (!file) return;
            
            const reader = new FileReader();
            reader.onload = (e) => {
                const csvData = parseCSV(e.target.result);
                orgData = extractOrgStructure(csvData);
                renderOrganization(orgData);
                generateLeaderboardData();
                generateWeekButtons();
                
                // í˜„ì¬ ì£¼ì°¨ ë²„íŠ¼ í™œì„±í™”
                const btns = document.querySelectorAll('.week-btn');
                btns.forEach((btn, idx) => {
                    if (idx + 1 === currentWeek) {
                        btn.classList.add('active');
                    }
                });
                
                updateLeaderboard();
            };
            reader.readAsText(file, 'UTF-8');
        }

        // ë¦¬ë”ë³´ë“œ ê´€ë ¨ ë³€ìˆ˜
        let currentMonth = new Date().getMonth() + 1;
        let currentWeek = 1;
        let leaderboardData = {};
        let dynamicUpdateInterval = null;
        let currentYearForLeaderboard = new Date().getFullYear();
        
        // í˜„ì¬ ë‚ ì§œ ì •ë³´
        function getCurrentDateInfo() {
            const now = new Date();
            const year = now.getFullYear();
            const month = now.getMonth() + 1;
            const date = now.getDate();
            
            // í•´ë‹¹ ì›”ì˜ ì£¼ì°¨ ê³„ì‚°
            const firstDay = new Date(year, month - 1, 1);
            const weekOfMonth = Math.ceil((date + firstDay.getDay()) / 7);
            
            return { year, month, week: weekOfMonth, date };
        }
        
        // íŠ¹ì • ì›”ì˜ ì´ ì£¼ì°¨ ìˆ˜ ê³„ì‚°
        function getWeeksInMonth(year, month) {
            const lastDay = new Date(year, month, 0).getDate();
            const firstDayOfWeek = new Date(year, month - 1, 1).getDay();
            return Math.ceil((lastDay + firstDayOfWeek) / 7);
        }
        
        // ë¯¸ë˜ ë‚ ì§œì¸ì§€ í™•ì¸
        function isFutureDate(year, month, week) {
            const now = getCurrentDateInfo();
            if (year > now.year) return true;
            if (year < now.year) return false;
            if (month > now.month) return true;
            if (month < now.month) return false;
            return week > now.week;
        }
        
        // í˜„ì¬ ì£¼ì°¨ì¸ì§€ í™•ì¸
        function isCurrentWeek(year, month, week) {
            const now = getCurrentDateInfo();
            return year === now.year && month === now.month && week === now.week;
        }

        // ë¦¬ë”ë³´ë“œ ë°ì´í„° ìƒì„±
        function generateLeaderboardData() {
            const allMembers = [];
            
            // ëª¨ë“  ë©¤ë²„ ìˆ˜ì§‘
            currentOrgData.organizations.forEach(org => {
                if (org.leader) {
                    allMembers.push({
                        name: org.leader,
                        org: org.name
                    });
                }
                org.members.forEach(member => {
                    allMembers.push({
                        name: member.name,
                        org: org.name
                    });
                });
            });

            leaderboardData = {};
            const categories = ['collaboration', 'quality', 'overtime', 'deadline', 'suggestion', 'overall'];
            const year = currentYearForLeaderboard;
            
            // ê° ë©¤ë²„ë³„ ì‹œë“œ ê°’ (ì¼ê´€ì„±ì„ ìœ„í•´)
            const memberSeeds = {};
            allMembers.forEach((member, idx) => {
                memberSeeds[member.name] = idx * 137; // ê³ ìœ í•œ ì‹œë“œ
            });
            
            // 1ì›”ë¶€í„° 12ì›”ê¹Œì§€
            for (let month = 1; month <= 12; month++) {
                const weeksInMonth = getWeeksInMonth(year, month);
                leaderboardData[month] = {};
                
                for (let week = 1; week <= weeksInMonth; week++) {
                    const weekKey = `${month}-${week}`;
                    leaderboardData[month][week] = {};
                    
                    categories.forEach(category => {
                        const memberScores = allMembers.map((member, idx) => {
                            const seed = memberSeeds[member.name];
                            const monthFactor = month * 0.05;
                            const weekFactor = week * 0.1;
                            
                            // ì‹œë“œ ê¸°ë°˜ ëœë¤ (ì¼ê´€ì„± ìœ ì§€)
                            const seededRandom = (seed + month * 100 + week * 10 + idx) % 100 / 100;
                            
                            let score;
                            switch(category) {
                                case 'collaboration':
                                    score = Math.floor(70 + seededRandom * 30 + monthFactor * 5);
                                    break;
                                case 'quality':
                                    score = Math.floor(65 + seededRandom * 35 + weekFactor * 3);
                                    break;
                                case 'overtime':
                                    score = Math.floor(30 + seededRandom * 50 + monthFactor * 3);
                                    break;
                                case 'deadline':
                                    score = Math.floor(70 + seededRandom * 30);
                                    break;
                                case 'suggestion':
                                    score = Math.floor(40 + seededRandom * 40 + weekFactor * 5);
                                    break;
                                case 'overall':
                                    score = Math.floor(65 + seededRandom * 35);
                                    break;
                            }
                            
                            return {
                                name: member.name,
                                org: member.org,
                                score: score,
                                change: 'same',
                                baseScore: score // ë™ì  ì—…ë°ì´íŠ¸ë¥¼ ìœ„í•œ ê¸°ì¤€ ì ìˆ˜
                            };
                        });
                        
                        // ì ìˆ˜ë¡œ ì •ë ¬
                        memberScores.sort((a, b) => b.score - a.score);
                        
                        leaderboardData[month][week][category] = memberScores;
                    });
                }
            }
            
            console.log('ë¦¬ë”ë³´ë“œ ë°ì´í„° ìƒì„± ì™„ë£Œ:', Object.keys(leaderboardData).length, 'ê°œì›”');
        }

        // ì£¼ì°¨ ë²„íŠ¼ ìƒì„±
        function generateWeekButtons() {
            const year = currentYearForLeaderboard;
            const weeksInMonth = getWeeksInMonth(year, currentMonth);
            const weekSelector = document.getElementById('weekSelector');
            weekSelector.innerHTML = '';
            
            for (let week = 1; week <= weeksInMonth; week++) {
                const btn = document.createElement('button');
                btn.className = 'week-btn';
                btn.textContent = `${week}ì£¼ì°¨`;
                btn.onclick = () => selectWeek(week);
                
                // í˜„ì¬ ì£¼ì°¨ í‘œì‹œ
                if (isCurrentWeek(year, currentMonth, week)) {
                    btn.classList.add('current-week');
                }
                
                weekSelector.appendChild(btn);
            }
            
            // ê¸°ë³¸ ì„ íƒ
            if (weekSelector.children.length > 0) {
                weekSelector.children[0].classList.add('active');
                currentWeek = 1;
            }
        }
        
        // ì›” ë³€ê²½
        function changeMonth() {
            const monthSelector = document.getElementById('monthSelector');
            currentMonth = parseInt(monthSelector.value);
            
            // ë™ì  ì—…ë°ì´íŠ¸ ì¤‘ì§€
            if (dynamicUpdateInterval) {
                clearInterval(dynamicUpdateInterval);
                dynamicUpdateInterval = null;
            }
            
            generateWeekButtons();
            
            // í˜„ì¬ ì£¼ì°¨ë¡œ ìë™ ì„ íƒ
            const now = getCurrentDateInfo();
            if (currentMonth === now.month) {
                currentWeek = now.week;
                const btns = document.querySelectorAll('.week-btn');
                btns.forEach((btn, idx) => {
                    btn.classList.remove('active');
                    if (idx + 1 === currentWeek) {
                        btn.classList.add('active');
                    }
                });
            }
            
            updateLeaderboard();
        }
        
        // ë¦¬ë”ë³´ë“œ ì—…ë°ì´íŠ¸
        function updateLeaderboard() {
            const category = document.getElementById('leaderboardCategory').value;
            const content = document.getElementById('leaderboardContent');
            const year = currentYearForLeaderboard;
            
            // ë™ì  ì—…ë°ì´íŠ¸ ì¤‘ì§€
            if (dynamicUpdateInterval) {
                clearInterval(dynamicUpdateInterval);
                dynamicUpdateInterval = null;
            }
            
            // ì„œë¸Œíƒ€ì´í‹€ ì—…ë°ì´íŠ¸
            document.getElementById('leaderboardSubtitle').textContent = `${currentMonth}ì›” ${currentWeek}ì£¼ì°¨`;
            
            // ë¯¸ë˜ ë‚ ì§œ ì²´í¬
            if (isFutureDate(year, currentMonth, currentWeek)) {
                content.innerHTML = `
                    <div class="empty-message">
                        <div class="empty-message-icon">ğŸ“…</div>
                        <div>ì•„ì§ ìˆœìœ„ê°€ ê²°ì •ë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤</div>
                        <div style="margin-top: 10px; font-size: 12px; opacity: 0.7;">
                            ${currentMonth}ì›” ${currentWeek}ì£¼ì°¨ëŠ” ì§„í–‰ ì¤‘ì´ì§€ ì•ŠìŠµë‹ˆë‹¤
                        </div>
                    </div>
                `;
                return;
            }
            
            // ë°ì´í„° ì¡´ì¬ í™•ì¸
            if (!leaderboardData[currentMonth] || !leaderboardData[currentMonth][currentWeek] || 
                !leaderboardData[currentMonth][currentWeek][category]) {
                content.innerHTML = '<div class="empty-message"><div class="empty-message-icon">ğŸ“Š</div><div>ë°ì´í„°ê°€ ì—†ìŠµë‹ˆë‹¤</div></div>';
                return;
            }
            
            const rankings = leaderboardData[currentMonth][currentWeek][category];
            
            // í˜„ì¬ ì£¼ì°¨ë©´ ë™ì  ì—…ë°ì´íŠ¸ ì‹œì‘
            if (isCurrentWeek(year, currentMonth, currentWeek)) {
                startDynamicUpdate(category);
            } else {
                renderRankings(rankings);
            }
        }
        
        // ìˆœìœ„ ë Œë”ë§
        function renderRankings(rankings) {
            const content = document.getElementById('leaderboardContent');
            content.innerHTML = '';
            
            rankings.forEach((member, index) => {
                const rank = index + 1;
                const rankClass = rank <= 3 ? `rank-${rank}` : '';
                
                let changeHTML = '';
                if (member.change === 'up') {
                    changeHTML = '<span class="rank-change up">â–²</span>';
                } else if (member.change === 'down') {
                    changeHTML = '<span class="rank-change down">â–¼</span>';
                } else {
                    changeHTML = '<span class="rank-change same">â”</span>';
                }
                
                const item = document.createElement('div');
                item.className = `rank-item ${rankClass}`;
                item.innerHTML = `
                    <div class="rank-number">${rank}</div>
                    <div class="rank-info">
                        <div class="rank-name">${member.name} ${changeHTML}</div>
                        <div class="rank-org">${member.org}</div>
                    </div>
                    <div class="rank-score">${member.score}</div>
                `;
                
                content.appendChild(item);
            });
        }
        
        // ë™ì  ì—…ë°ì´íŠ¸ ì‹œì‘ (í˜„ì¬ ì£¼ì°¨ìš©)
        function startDynamicUpdate(category) {
            const rankings = JSON.parse(JSON.stringify(
                leaderboardData[currentMonth][currentWeek][category]
            ));
            
            // ì´ì „ ìˆœìœ„ ì €ì¥
            const previousRanks = {};
            rankings.forEach((member, idx) => {
                previousRanks[member.name] = idx;
            });
            
            renderRankings(rankings);
            
            // 5ì´ˆë§ˆë‹¤ ì—…ë°ì´íŠ¸
            dynamicUpdateInterval = setInterval(() => {
                rankings.forEach((member, idx) => {
                    const currentRank = idx + 1;
                    
                    // ìƒìœ„ê¶Œ(1-5ë“±)ì€ ë³€ë™ì´ ì ê²Œ, í•˜ìœ„ê¶Œì€ ë³€ë™ì´ ë§ê²Œ
                    const volatility = currentRank <= 5 ? 0.3 : 
                                     currentRank <= 15 ? 0.5 : 0.7;
                    
                    if (Math.random() < volatility) {
                        // Â±3ì  ë²”ìœ„ ë‚´ì—ì„œ ì ìˆ˜ ë³€ë™
                        const change = Math.floor(Math.random() * 7) - 3;
                        member.score = Math.max(0, Math.min(100, member.score + change));
                    }
                });
                
                // ì ìˆ˜ë¡œ ì¬ì •ë ¬
                rankings.sort((a, b) => b.score - a.score);
                
                // ìˆœìœ„ ë³€ë™ ê³„ì‚° (ìµœëŒ€ Â±3ë“±)
                rankings.forEach((member, idx) => {
                    const oldRank = previousRanks[member.name] || idx;
                    const newRank = idx;
                    const diff = oldRank - newRank;
                    
                    // ìµœëŒ€ 3ë“±ê¹Œì§€ë§Œ ë³€ë™ í—ˆìš©
                    if (Math.abs(diff) > 3) {
                        // ê°•ì œë¡œ 3ë“± ë²”ìœ„ ë‚´ë¡œ ì¡°ì •
                        if (diff > 0) { // ìƒìŠ¹
                            member.score -= 2;
                        } else { // í•˜ë½
                            member.score += 2;
                        }
                    }
                    
                    if (diff > 0) member.change = 'up';
                    else if (diff < 0) member.change = 'down';
                    else member.change = 'same';
                    
                    previousRanks[member.name] = idx;
                });
                
                // ì¬ì •ë ¬ í›„ ë‹¤ì‹œ ë Œë”ë§
                rankings.sort((a, b) => b.score - a.score);
                renderRankings(rankings);
            }, 5000);
        }

        // ì£¼ì°¨ ì„ íƒ
        function selectWeek(week) {
            currentWeek = week;
            
            // ëª¨ë“  ì£¼ì°¨ ë²„íŠ¼ì˜ active í´ë˜ìŠ¤ ì œê±°
            document.querySelectorAll('.week-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            
            // ì„ íƒëœ ì£¼ì°¨ ë²„íŠ¼ì— active í´ë˜ìŠ¤ ì¶”ê°€
            const btns = document.querySelectorAll('.week-btn');
            if (btns[week - 1]) {
                btns[week - 1].classList.add('active');
            }
            
            updateLeaderboard();
        }

        window.addEventListener('load', () => {
            // í˜„ì¬ ë‚ ì§œë¡œ ì´ˆê¸°í™”
            const now = getCurrentDateInfo();
            currentMonth = now.month;
            currentWeek = now.week;
            
            // ì›” ì„ íƒê¸° ì´ˆê¸°í™”
            document.getElementById('monthSelector').value = currentMonth;
            
            fetch('ìŠˆí¼ìº£ ì¡°ì§ë„.csv')
                .then(response => response.text())
                .then(csvText => {
                    const csvData = parseCSV(csvText);
                    orgData = extractOrgStructure(csvData);
                    renderOrganization(orgData);
                    generateLeaderboardData();
                    generateWeekButtons();
                    
                    // í˜„ì¬ ì£¼ì°¨ ë²„íŠ¼ í™œì„±í™”
                    const btns = document.querySelectorAll('.week-btn');
                    btns.forEach((btn, idx) => {
                        if (idx + 1 === currentWeek) {
                            btn.classList.add('active');
                        }
                    });
                    
                    updateLeaderboard();
                    startSimulation();
                })
                .catch(error => {
                    console.log('CSV íŒŒì¼ì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤. ê¸°ë³¸ ë°ì´í„°ë¥¼ ì‚¬ìš©í•©ë‹ˆë‹¤.');
                    const defaultCSV = `ì¡°ì§ ë ˆë²¨,ì¡°ì§ëª…,ì¡°ì§ë¦¬ë”,ì§ì† ì¡°ì§,ì§ì†ì¡°ì§2,ì§ì†ì¡°ì§3,ì§ì†ì¡°ì§4,ì§ì†ì¡°ì§5,ì§ì†ì¡°ì§6,ì§ì†ì¡°ì§7,ì¡°ì§ì›1,ì¡°ì§ì›2,ì¡°ì§ì›3,ì¡°ì§ì›4,ì¡°ì§ì›5,ì¡°ì§ì›6,ì¡°ì§ì›7,ì¡°ì§ì›8,ì¡°ì§ì›9,ì¡°ì§ì›10,ì¡°ì§ì›11
1,PDì¡°ì§,ë°•ì„±ì¤€,í€„ë¦¬í‹° ë””ë ‰í„° ì¡°ì§,ê²Œì„ ë””ë ‰í„° ì¡°ì§,,,,,,,,,,,,,,,,
2,ê²Œì„ ë””ë ‰í„° ì¡°ì§,ì¥ìˆ˜ë¯¼,ê¸°íšíŒ€,í”„ë¡œê·¸ë¨íŒ€,ì•„íŠ¸íŒ€,,,,,,,,,,,,,,,
3,ê¸°íšíŒ€,ê¹€ë„ì—°,ë°¸ëŸ°ìŠ¤íŒŒíŠ¸,ì½˜í…ì¸ íŒŒíŠ¸,ì‹œìŠ¤í…œíŒŒíŠ¸,ê²Œì„UIíŒŒíŠ¸,,,,,,,,,,,,,,
3,í”„ë¡œê·¸ë¨íŒ€,ìœ í˜¸ì˜,í´ë¼ì´ì–¸íŠ¸íŒŒíŠ¸,ì„œë²„íŒŒíŠ¸,,,,,,,,,,,,,,,,
3,ì•„íŠ¸íŒ€,ì¥ê°€ëŒ,2Dì•„íŠ¸íŒ€,3Dì•„íŠ¸íŒ€,,,,,,,,,,,,,,,,
3,í€„ë¦¬í‹° ë””ë ‰í„° ì¡°ì§,ì´ì„í˜¸,PMíŒŒíŠ¸,QAíŒŒíŠ¸,ë¹Œë“œíŒŒíŠ¸,,,,,,,,,,,,,,,
4,PMíŒŒíŠ¸,ê¹€ë¯¼ì„,,,,,,,,"ì†íš¨ì‹
(PM)","ì¡°ì•„ì˜
(PM)",,,,,,,,,
4,QAíŒŒíŠ¸,ì¡°ìƒí˜¸,,,,,,,,"ì„ì¬ì—½
(QA)","ê°•ì§„ì‹¤
(QA)",,,,,,,,,
4,ë¹Œë“œíŒŒíŠ¸,ìœ í˜¸ì˜,,,,,,,,"ì˜¤ì„±ê´‘
(PM)","ê¹€ì£¼í˜•
(QA)","ì˜¤ì„±í˜
(QA)",,,,,,,,
4,ë°¸ëŸ°ìŠ¤íŒŒíŠ¸,ì„œì„±ì² ,,,,,,,,"ë…¸í˜•ì›
(ê¸°íš)","ìœ¤í˜•ê¸°
(ê¸°íš)","ë°•ì„±ì›
(ê¸°íš)","ìµœì„±ì€
(ê¸°íš)",,,,,,,
4,ì½˜í…ì¸ íŒŒíŠ¸,ì´í˜„ë¯¼,,,,,,,,"ì´ê²½ë¯¼
(ê¸°íš)","ì •ìœ¤ì£¼
(ê¸°íš)","ë°•ì¤€ìƒ
(ê¸°íš)","ì´ì¬ì²­
(ê¸°íš)","ì‹ ì§€í›ˆ
(ê¸°íš)","ê¹€ë³´ì˜
(ê¸°íš)","ìµœì¤€í˜•
(ê¸°íš)",,,,
4,ì‹œìŠ¤í…œíŒŒíŠ¸,ì¡°ìœ ë¹ˆ,,,,,,,,"ë°•ì—°í¬
(ê¸°íš / ì„ ì„)","ì´í˜¸ì§„
(ê¸°íš)","ê¹€ì„ í™
(ê¸°íš)","ì´ì€ì„œ
(ê¸°íš)",,,,,,,
4,ê²Œì„UIíŒŒíŠ¸,ìš°ìˆ˜ì§„,,,,,,,,"ì „ìˆ˜ë¯¼
(UI/UX)","ê°•ì€í¬
(UI/UX)","ê¹€ë¯¼ì•„
(UI/UX)",,,,,,,,
4,í´ë¼ì´ì–¸íŠ¸íŒŒíŠ¸,í™©í˜„ì‹,,,,,,,,"ì´ê·¼ìˆ˜ 
(í”„ë¡œê·¸ë¨ / ì„ ì„)","ì´ì¬í™˜
(í”„ë¡œê·¸ë¨)","ìœ ì°½ë¯¼
(í”„ë¡œê·¸ë¨)","ì´ì •íƒœ
(í”„ë¡œê·¸ë¨)","ì •ì£¼í›ˆ
(í”„ë¡œê·¸ë¨)","ìµœê·œí™˜
(í”„ë¡œê·¸ë¨)","ì¶”ì—°ì±„
(í”„ë¡œê·¸ë¨)","ì´ì¼ê·œ
(í”„ë¡œê·¸ë¨)","ë°•í˜•ìš°
(í”„ë¡œê·¸ë¨)","ëª¨ì„±ë¯¼ 
(í”„ë¡œê·¸ë¨)","ê¹€ì¬ê¸°
(í”„ë¡œê·¸ë¨)"
4,ì„œë²„íŒŒíŠ¸,ì¡°í¬ì„ ,,,,,,,,"ìµœìµí•„
(í”„ë¡œê·¸ë¨)","ìœ¤ì˜ì¤€ 
(í”„ë¡œê·¸ë¨)","ì´ì¬í˜•
(í”„ë¡œê·¸ë¨)","ì†¡ì§„ë¯¼ 
(í”„ë¡œê·¸ë¨)","ì†¡ì¤€í˜¸
(í”„ë¡œê·¸ë¨)",,,,,,
4,2Dì•„íŠ¸íŒ€,ì¥ê°€ëŒ,ë„íŠ¸ë””ìì¸1íŒŒíŠ¸,ë„íŠ¸ë””ìì¸2íŒŒíŠ¸,ë„íŠ¸ì• ë‹ˆë©”ì´ì…˜1íŒŒíŠ¸,ë„íŠ¸ì• ë‹ˆë©”ì´ì…˜2íŒŒíŠ¸,ê°€ì´ë“œëª¨ë¸ë§íŒŒíŠ¸,ì»¨ì…‰ì›í™”íŒŒíŠ¸,,,,,,,,,,,,
4,3Dì•„íŠ¸íŒ€,ë°•ì¸í™˜,ë°°ê²½ì›í™”íŒŒíŠ¸,ë°°ê²½ëª¨ë¸ë§íŒŒíŠ¸,ë°°ê²½ì›”ë“œë¹Œë”©íŒŒíŠ¸,3Dìºë¦­í„°ëª¨ë¸ë§íŒŒíŠ¸,3Dì• ë‹ˆë©”ì´ì…˜íŒŒíŠ¸,ì´í™íŠ¸íŒŒíŠ¸,TAíŒŒíŠ¸,,,,,,,,,,,
5,ë„íŠ¸ë””ìì¸1íŒŒíŠ¸,ê¹€ì£¼ì—°,,,,,,,,"ì „í˜„ì¤€
(ì•„íŠ¸ / ì„ ì„)","ì†¡ê¸°í˜„
(ì•„íŠ¸)","ì´ê²½ì§„B
(ì•„íŠ¸)",,,,,,,,
5,ë„íŠ¸ë””ìì¸2íŒŒíŠ¸,ì°¨ì¤€ì˜,,,,,,,,"ì¥ì§€ì—°
(ì•„íŠ¸ / ì„ ì„)","ê¹€íš¨ì •
(ì•„íŠ¸)","ì •í¬ì—°
(ì•„íŠ¸)","ê¹€ì˜ì€
(ì•„íŠ¸)",,,,,,,
5,ë„íŠ¸ì• ë‹ˆë©”ì´ì…˜1íŒŒíŠ¸,ì¡°ì‹ ìš°,,,,,,,,"ê¹€ì€í¬
(ì•„íŠ¸ / ì„ ì„)","ë°•íƒœì–‘
(ì•„íŠ¸)","ì§„ì˜í›ˆ
(ì•„íŠ¸)","ì±„ì¢…ìˆ˜
(ì•„íŠ¸)","ê¹€ìˆ˜ì§„B
(ì•„íŠ¸)","ì •ë‹¤ìŠ¬
(ì•„íŠ¸)",,,,,
5,ë„íŠ¸ì• ë‹ˆë©”ì´ì…˜2íŒŒíŠ¸,ê¹€ì •ì—½,,,,,,,,"ì´ì¤€í˜¸
(ì•„íŠ¸)","ìµœí¬ì¤€
(ì•„íŠ¸)","ê¹€ìœ¤ì¬
(ì•„íŠ¸)","ì „í˜œì§€
(ì•„íŠ¸)","ìœ ì§„ì›…
(ì•„íŠ¸)",,,,,,
5,ê°€ì´ë“œëª¨ë¸ë§íŒŒíŠ¸,ë°•ìƒë¯¼,,,,,,,,"ê¹€ì˜í•˜
(ì•„íŠ¸ / ì„ ì„)","ìš©í™˜ë¯¼
(ì•„íŠ¸)","ê¹€ìœ¤ì„ 
(ì•„íŠ¸)",,,,,,,,
5,ì»¨ì…‰ì›í™”íŒŒíŠ¸,ìœ ê²½ë¯¼,,,,,,,,"ì§€í˜œì–‘
(ì•„íŠ¸ / ì„ ì„)","í™ì„±ëª…
(ì•„íŠ¸)","ê¹€ìˆ˜ì§„
(ì•„íŠ¸)","ë‚¨ë‹¤ìœ„
(ì•„íŠ¸)","ê¹€ë‹¤ì†œ
(ì•„íŠ¸)",,,,,,
5,ë°°ê²½ì›í™”íŒŒíŠ¸,ê°•ë„í™,,,,,,,,"ê¹€ìƒì¡°
(ì•„íŠ¸ / ì„ ì„)","ì •í˜œì˜
(ì•„íŠ¸)","ì¡°ë™ì£¼
(ì•„íŠ¸)","ì •ê²½ì›
(ì•„íŠ¸)","ì´ì„±ìš°
(ì•„íŠ¸)",,,,,,
5,ë°°ê²½ëª¨ë¸ë§íŒŒíŠ¸,ì¡°í˜„ê¸°,,,,,,,,"ì„œë¯¸ì •
(ì•„íŠ¸)","ê¸°íƒœì–‘
(ì•„íŠ¸)","ì´ì£¼ì—°
(ì•„íŠ¸)","í™ìœ ì§„
(ì•„íŠ¸)",,,,,,,
5,ë°°ê²½ì›”ë“œë¹Œë”©íŒŒíŠ¸,ê°•ë™í˜¸,,,,,,,,"ê¹€í˜•ì°¬
(ì•„íŠ¸)","ê¹€í¬ì• 
(ì•„íŠ¸)",,,,,,,,,
5,3Dìºë¦­í„°ëª¨ë¸ë§íŒŒíŠ¸,ë°•ì •ê· ,,,,,,,,"ê¹€í•´í˜„
(ì•„íŠ¸)","ì†ì˜ë°°
(ì•„íŠ¸)",,,,,,,,,
5,3Dì• ë‹ˆë©”ì´ì…˜íŒŒíŠ¸,ìœ¤ë¯¼ìš°,,,,,,,,"ìœ¤í˜œì§€
(ì•„íŠ¸)","ì˜¤ì§€í˜„
(ì•„íŠ¸)",,,,,,,,,
5,ì´í™íŠ¸íŒŒíŠ¸,ê¹€ìˆ˜ì™„,,,,,,,,"ì•ˆì°½ìš©
(ì•„íŠ¸)","ì´ìš±ì„ 
(ì•„íŠ¸)","ê¹€ìœ ë¦¼
(ì•„íŠ¸)",,,,,,,,
5,TAíŒŒíŠ¸,ìµœìƒí›ˆ,,,,,,,,"í™©íƒœì¤€
(ì•„íŠ¸)",,,,,,,,,,`;
                    
                    const csvData = parseCSV(defaultCSV);
                    orgData = extractOrgStructure(csvData);
                    renderOrganization(orgData);
                    generateLeaderboardData();
                    generateWeekButtons();
                    
                    // í˜„ì¬ ì£¼ì°¨ ë²„íŠ¼ í™œì„±í™”
                    const btns = document.querySelectorAll('.week-btn');
                    btns.forEach((btn, idx) => {
                        if (idx + 1 === currentWeek) {
                            btn.classList.add('active');
                        }
                    });
                    
                    updateLeaderboard();
                    startSimulation();
                });
        });
    </script>
</body>
</html>